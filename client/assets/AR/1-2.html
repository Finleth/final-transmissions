<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Chapter 2</title>
        <link rel="stylesheet" type="text/css" href="../css/ARstyle.css" />

        <script src="../lib/aframe.js"></script>
        <script src="../lib/aframe-ar.js"></script>

    </head>
    <body style='margin : 0; overflow: hidden;'>

    <a-scene embedded artoolkit='sourceType: webcam;'>

        <a-assets>
            <video id="water1" src="../video/Rain-78.ogv" loop="true"></video>
            <video id="water2" src="../video/Rain-78.ogv" loop="true"></video>
        </a-assets>

        <a-marker preset='water'>

            <a-entity>
                <a-octahedron src='#water1' radius="0.5" material="opacity: 0.9" position="-0.5 -0.75 -1.5">
                    <a-animation attribute="rotation"
                                 dur="5000"
                                 to="360 360 360"
                                 easing= "linear"
                                 repeat="indefinite">
                    </a-animation>
                    <a-animation attribute="position"
                                 dur="3000"
                                 from="-0.5 0.75 -1.5"
                                 to="-0.5 0.75 0"
                                 direction="alternate-reverse"
                                 easing= "linear"
                                 repeat="indefinite">
                    </a-animation>
                </a-octahedron>
            </a-entity>
            <a-entity>
                <a-octahedron src='#water2' radius="0.5" material="opacity: 0.9" position="0.5 -0.75 0">
                    <a-animation attribute="rotation"
                                 dur="5000"
                                 to="-360 -360 -360"
                                 easing= "linear"
                                 repeat="indefinite">
                    </a-animation>
                    <a-animation attribute="position"
                                 dur="5000"
                                 from="0.5 0.75 0"
                                 to="0.5 0.75 -1.5"
                                 direction="alternate-reverse"
                                 easing= "linear"
                                 repeat="indefinite">
                    </a-animation>
                </a-octahedron>
            </a-entity>

            <a-entity light="type: ambient; color: #ccc; intensity: 3.0"></a-entity>
            <a-entity light="type: spot; angle: 45; color: #3A43D4; intensity: 3.0" id="blue"></a-entity>

    </a-scene>

    <script>

        var water1 = document.getElementById("water1");
        var water2 = document.getElementById("water2");
        var found = false;

        window.addEventListener("load", function(){
            water1.currentTime = 1000;
            water1.play();
            water2.currentTime = 6000;
            water2.playbackRate = 1.3;
            water2.play();
        });

        window.addEventListener("markerFound", function(){
            if (!found){
                console.log("MARKER FOUND!");
                found = true;
                var timer = setTimeout(function(){
                    window.parent.markerListener();
                }, 5000);

            }
        });


    </script>


    </body>
</html>